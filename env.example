# Configuration for code-rag
# Copy this file to .env and modify as needed

# Embedding model to use for generating vector embeddings
CODE_RAG_EMBEDDING_MODEL=nomic-ai/CodeRankEmbed

# Database type: 'chroma' or 'qdrant'
CODE_RAG_DATABASE_TYPE=chroma

# Database path (optional, defaults to cache directory if not set)
# CODE_RAG_DATABASE_PATH=.code-rag

# Chunk size in characters for splitting files
CODE_RAG_CHUNK_SIZE=1024

# Batch size for processing documents
CODE_RAG_BATCH_SIZE=32

# Whether to include file headers in chunks (true/false)
CODE_RAG_INCLUDE_FILE_HEADER=true

# Whether to exclude test files from indexing (true/false)
CODE_RAG_EXCLUDE_TESTS=false

# Additional ignore patterns (comma-separated list)
# Examples: *.log,*.tmp,custom_ignore_dir/
CODE_RAG_ADDITIONAL_IGNORE_PATTERNS=

# Whether reranking is enabled (true/false)
CODE_RAG_RERANKER_ENABLED=false

# Reranker model to use
CODE_RAG_RERANKER_MODEL=jinaai/jina-reranker-v3

# Retrieval multiplier for reranking
CODE_RAG_RERANKER_MULTIPLIER=2

# Incremental indexing configuration
# Minimum minutes between automatic reindexing (default: 10)
CODE_RAG_REINDEX_DEBOUNCE_MINUTES=10

# Whether to verify file changes with content hash for accuracy (true/false)
# Set to true for 100% accuracy, false for faster checks (default: true)
CODE_RAG_VERIFY_CHANGES_WITH_HASH=true

# Model idle timeout in seconds (default: 1800 = 30 minutes)
# Models auto-unload after this period of inactivity
CODE_RAG_MODEL_IDLE_TIMEOUT=1800

# ==========================================
# Shared Embedding Server Configuration
# ==========================================
# When enabled, multiple MCP instances share a single model via HTTP server.
# This dramatically reduces memory usage when using code-rag in multiple places.
# The server auto-starts on demand and auto-terminates when no clients remain.

# Enable shared embedding server mode (true/false, default: true)
CODE_RAG_SHARED_SERVER=true

# Starting port for the shared embedding server (default: 8199)
# If this port is in use, the server will automatically find the next available port.
# Clients always read the actual port from the server info file, so this is just a starting point.
CODE_RAG_SHARED_SERVER_PORT=8199
